╭───────────────────────────────────────╮
│ Multi-Feature Fusion Experiments      │
│ Device: cuda | Folds: [1, 2, 3, 4, 5] │
╰───────────────────────────────────────╯

Loading ESC-50 dataset...
✓ Loaded 2000 samples

Creating base retrievers...
  ✓ M1_MFCC
  ✓ M2_MFCC_Delta
  ✓ M3_LogMel
  ✓ M4_Spectral

Evaluating Individual Methods
⠏ Individual methods                                  0% 0:08:14

Late Fusion Grid Search
  Retrievers: ['M1_MFCC', 'M3_LogMel', 'M4_Spectral']
  Weight combinations: 15
⠋ Late Fusion                                  0% 1:17:56 -:--:--
                   Late Fusion Results (Top 10)                    
╭──────┬──────┬────────┬──────────┬───────────────┬───────────────╮
│ Rank │ MFCC │ LogMel │ Spectral │    Hit@10     │    mAP@20     │
├──────┼──────┼────────┼──────────┼───────────────┼───────────────┤
│ 1    │ 0.50 │  0.50  │   0.00   │ 0.6640±0.0304 │ 0.0740±0.0047 │
│ 2    │ 0.75 │  0.25  │   0.00   │ 0.6610±0.0297 │ 0.0717±0.0041 │
│ 3    │ 0.50 │  0.25  │   0.25   │ 0.6605±0.0249 │ 0.0690±0.0066 │
│ 4    │ 0.25 │  0.75  │   0.00   │ 0.6595±0.0311 │ 0.0746±0.0054 │
│ 5    │ 0.75 │  0.00  │   0.25   │ 0.6590±0.0258 │ 0.0681±0.0061 │
│ 6    │ 0.25 │  0.50  │   0.25   │ 0.6570±0.0223 │ 0.0694±0.0068 │
│ 7    │ 0.00 │  0.75  │   0.25   │ 0.6515±0.0242 │ 0.0694±0.0070 │
│ 8    │ 1.00 │  0.00  │   0.00   │ 0.6500±0.0212 │ 0.0661±0.0038 │
│ 9    │ 0.00 │  1.00  │   0.00   │ 0.6420±0.0257 │ 0.0738±0.0055 │
│ 10   │ 0.25 │  0.25  │   0.50   │ 0.6390±0.0238 │ 0.0624±0.0053 │
╰──────┴──────┴────────┴──────────┴───────────────┴───────────────╯

Rank Fusion (RRF)
  Retrievers: ['M1_MFCC', 'M2_MFCC_Delta', 'M3_LogMel']
⠙ Rank Fusion                                  0% 0:03:42 -:--:--


                Fusion vs Individual Methods                 
╭────────────────────┬────────────┬────────────┬────────────╮
│ Method             │   Hit@10   │    P@10    │   mAP@20   │
├────────────────────┼────────────┼────────────┼────────────┤
│ M1_MFCC            │   0.6500   │   0.1676   │   0.0661   │
│ M2_MFCC_Delta      │   0.6550   │   0.1713   │   0.0683   │
│ M3_LogMel          │   0.6420   │   0.1788   │   0.0738   │
│ M4_Spectral        │   0.5500   │   0.1174   │   0.0421   │
│ ──────────         │ ────────── │ ────────── │ ────────── │
│ Late Fusion (Best) │   0.6640   │   0.1807   │   0.0740   │
│ Rank Fusion (RRF)  │   0.6625   │   0.1775   │   0.0721   │
╰────────────────────┴────────────┴────────────┴────────────╯

✓ Results saved to 
/llm_jzm/shx/digit/DSP-HW/experiments/retrieval/results/fusion/20251218_051444
╭───────────────────────────────╮
│ Fusion experiments completed! │
╰───────────────────────────────╯
