╭──────────────────────────────────────────────────╮
│ Hyperparameter Grid Search                       │
│ Strategy: 3-step efficient search | Device: cuda │
╰──────────────────────────────────────────────────╯

Loading ESC-50 dataset...
✓ Loaded 2000 samples

Step 1: Frame/Hop Sweep (14 configs)
  Frame lengths: [20, 25, 40, 80] ms
  Hop lengths: [5, 10, 20, 40] ms
  Fixed: n_mels=64, n_mfcc=20, window=hann
  Folds: [5]
  Step 1 Progress ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:04:23 0:00:00
              Step 1 Results: Frame/Hop Sweep              
╭──────┬────────────┬──────────┬───────┬─────────┬────────╮
│ Rank │ Frame (ms) │ Hop (ms) │ n_fft │ hop_len │ hit@10 │
├──────┼────────────┼──────────┼───────┼─────────┼────────┤
│ 1    │     40     │    5     │  882  │   110   │ 0.6850 │
│ 2    │     25     │    5     │  551  │   110   │ 0.6825 │
│ 3    │     40     │    10    │  882  │   220   │ 0.6825 │
│ 4    │     40     │    20    │  882  │   441   │ 0.6825 │
│ 5    │     80     │    20    │ 1764  │   441   │ 0.6800 │
│ 6    │     80     │    40    │ 1764  │   882   │ 0.6800 │
│ 7    │     20     │    5     │  441  │   110   │ 0.6775 │
│ 8    │     25     │    10    │  551  │   220   │ 0.6775 │
│ 9    │     80     │    5     │ 1764  │   110   │ 0.6775 │
│ 10   │     80     │    10    │ 1764  │   220   │ 0.6775 │
╰──────┴────────────┴──────────┴───────┴─────────┴────────╯

Step 2: n_mels × n_mfcc Sweep (27 configs)
  n_mels: [40, 64, 128]
  n_mfcc: [13, 20, 40]
  Base configs: 3
  Step 2 Progress ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:09:48 0:00:00
           Step 2 Results: MFCC Parameter Sweep            
╭──────┬────────────┬──────────┬────────┬────────┬────────╮
│ Rank │ Frame (ms) │ Hop (ms) │ n_mels │ n_mfcc │ hit@10 │
├──────┼────────────┼──────────┼────────┼────────┼────────┤
│ 1    │     40     │    5     │  128   │   40   │ 0.6950 │
│ 2    │     40     │    5     │   64   │   40   │ 0.6925 │
│ 3    │     40     │    10    │   64   │   40   │ 0.6925 │
│ 4    │     40     │    10    │  128   │   40   │ 0.6900 │
│ 5    │     40     │    5     │  128   │   13   │ 0.6875 │
│ 6    │     40     │    5     │   64   │   20   │ 0.6850 │
│ 7    │     40     │    10    │  128   │   13   │ 0.6850 │
│ 8    │     25     │    5     │   64   │   20   │ 0.6825 │
│ 9    │     25     │    5     │  128   │   20   │ 0.6825 │
│ 10   │     25     │    5     │  128   │   40   │ 0.6825 │
╰──────┴────────────┴──────────┴────────┴────────┴────────╯

Step 3: Window Function Comparison (Full 5-fold CV)
  Windows: ['hann', 'hamming', 'boxcar']
  Best config: n_fft=882, hop=110, n_mels=128, n_mfcc=40
  Step 3 Progress ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:06:18 0:00:00
          Step 3 Results: Window Function (5-fold CV)          
╭─────────┬────────┬──────────────┬────────┬────────┬─────────╮
│ Window  │ hit@10 │ precision@10 │ mrr@10 │ map@20 │ ndcg@10 │
├─────────┼────────┼──────────────┼────────┼────────┼─────────┤
│ hann    │ 0.6725 │    0.1795    │ 0.3926 │ 0.0715 │ 0.1990  │
│ hamming │ 0.6715 │    0.1779    │ 0.3914 │ 0.0711 │ 0.1973  │
│ boxcar  │ 0.6600 │    0.1693    │ 0.3873 │ 0.0682 │ 0.1905  │
╰─────────┴────────┴──────────────┴────────┴────────┴─────────╯

Step 4 (fmin/fmax sweep) is disabled. Skipping.


╭───────────────────────────────────╮
│ Best Configuration Found          │
│                                   │
│ Frame length: 40 ms (n_fft=882)   │
│ Hop length: 5 ms (hop_length=110) │
│ n_mels: 128                       │
│ n_mfcc: 40                        │
│ Window: hann                      │
│                                   │
│ Hit@10: 0.6725                    │
│ mAP@20: 0.0715                    │
╰───────────────────────────────────╯

✓ Results saved to 
/llm_jzm/shx/digit/DSP-HW/experiments/retrieval/results/grid_search/20251218_041636
╭─────────────────────────────────────╮
│ Grid search completed successfully! │
╰─────────────────────────────────────╯
